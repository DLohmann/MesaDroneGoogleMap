<!DOCTYPE html>
<html>
	<head>
	<meta name="viewport" content="initial-scale=1.0,user-scalable=no" />
	<meta charset="utf-8"/>
	<style type="text/css">
		html { height: 100% }
		body { height: 100%; margin: 0; padding: 0 }
		#map-canvas { height: 100% }
	</style>
	<script type="text/javascript"
		src="https://maps.googleapis.com/maps/api/js?
		key=AIzaSyALt375cV7B_ZO_HCHtKM6G79sJsyI0zmU
&libraries=drawing"></script>
	</head>
	<body ondragstart="return false">
		
		
		
		
			<br>
			<div id="latitudeText" class="generalInputField">Latitude<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
			</div>
			<form id="latitudeForm" class="inputValue" onsubmit="initLocation(); return false">
				<input id="latitudeField" class="inputBorder numberField" type="number" step="any"  name="latitudeInput" placeholder="37.374712">
			</form>
		
		
					<div id="longitudeText" class="generalInputField">Longitude<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
			</div>
			<form id="longitudeForm" class="inputValue" onsubmit="initLocation(); return false">
				<input id="longitudeField" class="inputBorder numberField" type="number" step="any" name="longitudeInput" placeholder="-120.577858">
			</form>
		
		
   
		<br>
	
		<button type="button" id="startButton" onclick="initLocation(); return false">Start Program</button>
		<br>
        <br>
		
                <div id="info"></div>

		
		<div id ="map-canvas"></div>
		<input class="w3-button w3-black" type="button" value="Input Button">
        
		
		
		
		
		
		
		<script type="text/javascript" >
			var map;
            var markerXPos;
            var markerYPos;
			var currentTime = 0.0;
			var marker;
			// Starting position of the map
			var latitude = 37.374712;
			var longitude = -120.577858;
            
            var outerPolygon;
            var innerPolygon;
			
			// Current position of drone
			var droneLatLng = null;
			
			function initialize()
			{
				// Add map
                
                markerXPos = latitude;
                markerYPos = longitude;
                
				var mapOptions =
				{
					// center: new google.maps.LatLng(37.374712, -120.577858),
					center: new google.maps.LatLng(latitude, longitude),
					zoom: 19,
					mapTypeId: google.maps.MapTypeId.SATELLITE,
                    keyboardShortcuts: false,
				};
				map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
				map.setTilt(0);
				
				var drawingManager = new google.maps.drawing.DrawingManager({
					drawingMode: google.maps.drawing.OverlayType.MARKER,
					drawingControl: true,
					drawingControlOptions: {
						position: google.maps.ControlPosition.TOP_CENTER,
						drawingModes: ['marker', 'circle', 'polygon', 'polyline', 'rectangle']
					},
					markerOptions: {icon: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png'},
					circleOptions: {
						fillColor: 'rgba(0, 98, 255, 0.46)',
						fillOpacity: 1,
						strokeWeight: 5,
						clickable: false,
						editable: true,
						zIndex: 1
					},
                         polygonOptions: {
            fillColor: 'rgba(255, 255, 255, 0)',
            fillOpacity: 0.5,
            strokeWeight: 2,
            strokeColor: '#57ACF9',
            clickable: false,
            editable: false,
            zIndex: 1
        }
				});
                    console.log(drawingManager)

				drawingManager.setMap(map);
                
                   google.maps.event.addListener(drawingManager, 'polygoncomplete', function (polygon) {
        document.getElementById('info').innerHTML += "polygon points:" + "<br>";
        for (var i = 0; i < polygon.getPath().getLength(); i++) {
            document.getElementById('info').innerHTML += polygon.getPath().getAt(i).toUrlValue(6) + "<br>";
        
           
        }
       var innerCoords = polygon.getPath();
                                
                       
//        37.374993,-120.578409
//37.375699,-120.577867
//37.374872,-120.577339
                       
           // Define the LatLng coordinates for the polygon's  outer path.
        var outerCoords = [
          {lat: 37.288447, lng: -121.136101},
          {lat: 37.860948, lng: -120.603264},
          {lat: 37.242545, lng: -120.102013}
        ];
                       
                       
             

        // Define the LatLng coordinates for the polygon's inner path.
        // Note that the points forming the inner path are wound in the
        // opposite direction to those in the outer path, to form the hole.
//        var innerCoords = [
//          {lat: 37.375153, lng: -120.578415},
//          {lat: 37.375143, lng: -120.577395},
//            {lat: 37.375688, lng: -120.577414},
//          {lat: 37.375699, lng: -120.578433}
//        ];
                     
                   

                       

        // Construct the polygon, including both paths.
        var bermudaTriangle = new google.maps.Polygon({
          paths: [outerCoords, innerCoords],
          strokeColor: '#FFC107',
          strokeOpacity: 0.8,
          strokeWeight: 2,
          fillColor: '#000000',
          fillOpacity: 0.9
        });
        bermudaTriangle.setMap(map);

    });
                
				
				// Add event listener
				google.maps.event.addListener(map, 'zoom_changed',
					function()
					{
					//alert(map.getZoom());
					}
				);
				
				// Add marker
				marker = new google.maps.Marker(
				{
					position: new google.maps.LatLng(37.374712, -120.577858),
					map: map,
					title: "Marker A",
                    icon: 'arrowIcon.png',
				});
				google.maps.event.addListener(marker, 'click', function()
				{
					map.panTo(marker.getPosition());
				});
				marker.setMap(map); 
                
                
                
                
			}
			
			
			
			google.maps.event.addDomListener(window, 'load', initialize);
			
			function updateMarkerLocation(lat,lon){

				droneLatLng = new google.maps.LatLng (lat, lon);
				marker.setPosition (droneLatLng);
				
				console.log ("Updated location to (" + latitude + ", " + longitude + ")\n");
                
                markerXPos = lat;
                markerYPos = lon;
			};
			
			function circlePoint(time) {
				var radius = 0.001;
				var x = Math.cos(time) * radius;
				var y = Math.sin(time) * radius;
				updateMarkerLocation (latitude + x, longitude + y);
				//return {lat:window.lat + y, lng:window.lng + x};
			};
			
			function updateMarker () {
				currentTime = currentTime + 0.01;
				circlePoint (currentTime);
			}
			
			function initLocation(){
				latitude = Number(document.forms[0].latitudeInput.value);	   
				longitude = Number(document.forms[1].longitudeInput.value);
                
                markerXPos = latitude;
                markerYPos = longitude;
                
				initialize();
                
              
                
                updateMarkerLocation(latitude, longitude);
			}
			//setInterval ("updateMarker ()", 10);
            
            
            
            
// When an arrow key is pressed, use checkKey function
            
            window.addEventListener("keydown", function(e) {
    // space and arrow keys
    if([32, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {
        e.preventDefault();
    }
}, false);
            
document.onkeydown = checkKey;      
            
// Use cases depending on key pressed
function checkKey(e) {

    e = e || window.event;

    if (e.keyCode == '38') {
        // up arrow
        updateMarkerLocation(markerXPos + 0.000015, markerYPos);
       
    }
    else if (e.keyCode == '40') {
        // down arrow
               updateMarkerLocation(markerXPos - 0.000015, markerYPos);
    }
    else if (e.keyCode == '37') {
       // left arrow
               updateMarkerLocation(markerXPos, markerYPos - 0.000015);
    }
    else if (e.keyCode == '39') {
       // right arrow
               updateMarkerLocation(markerXPos, markerYPos + 0.000015);
    }

}
			
		</script>
	</body>
</html>
